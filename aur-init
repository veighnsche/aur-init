#!/bin/bash
set -euo pipefail

# Resolve script and library locations for both dev and installed usage
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
if [[ -d "$SCRIPT_DIR/lib" ]]; then
  LIB_DIR="$SCRIPT_DIR/lib"
elif [[ -d "/usr/lib/aur-init/lib" ]]; then
  LIB_DIR="/usr/lib/aur-init/lib"
else
  LIB_DIR="$SCRIPT_DIR/lib" # fallback; sourcing will be best-effort
fi

# Python implementation is required
if ! command -v python3 >/dev/null 2>&1; then
  echo "python3 not found; please install Python (base Arch)" >&2
  exit 1
fi
if [[ ! -f "$LIB_DIR/aur_init.py" ]]; then
  echo "aur_init.py not found in $LIB_DIR" >&2
  exit 1
fi
exec python3 "$LIB_DIR/aur_init.py" "$@"
exit 0
